# am-editor

<img width="1676" alt="Demo" src="https://user-images.githubusercontent.com/55792257/119711922-a359b500-be92-11eb-9f77-459b6d468be9.png">

am-editorï¼Œä¸€ä¸ªåŸºäº[ShareDB](https://github.com/share/sharedb) çš„ Web å¤šäººååŒå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œé€‚ç”¨äº`React`ã€`Vue`æ¡†æ¶ï¼Œä¸ä¸»æµçš„ç°ä»£æµè§ˆå™¨å…¼å®¹ã€‚

[æŸ¥çœ‹åœ¨çº¿æ–‡æ¡£åŠæ¼”ç¤º](https://editor.aomao.com)

æŠ€æœ¯äº¤æµ QQ ç¾¤ï¼š907664876

[ç§‘å­¦ä¸Šç½‘ï¼Œæ–¹ä¾¿ã€å¿«æ·çš„ä¸Šç½‘å†²æµª](https://xiyou4you.us/r/?s=18517120)

am-editorï¼Œä¸€ä¸ª Web å¤šäººå®æ—¶ååŒå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€‚ä½¿ç”¨æµè§ˆå™¨æä¾›çš„`contenteditable`å±æ€§è®©ä¸€ä¸ª DOM èŠ‚ç‚¹å…·æœ‰å¯ç¼–è¾‘èƒ½åŠ›ã€‚

ä¼—æ‰€å‘¨çŸ¥`contenteditable`å±æ€§ï¼Œåœ¨ä¸åŒçš„æµè§ˆå™¨å‚å•†ä¸­å®ç°ä¼šæœ‰ä¸åŒçš„å·®å¼‚ï¼Œå¹¶ä¸”å…¶é»˜è®¤è¡Œä¸ºå…·æœ‰ä¸å¯é¢„æµ‹æ€§ï¼Œå› æ­¤æˆ‘ä»¬å°è£…äº†ä¸€ä¸ªå…·æœ‰ä¸€å®šå¯æ§æ€§çš„ç¼–è¾‘èƒ½åŠ›å¼•æ“åº“`@aomao/engine`ï¼Œåœ¨é»˜è®¤è¡Œä¸ºå’ŒæœŸæœ›è¡Œä¸ºä¹‹é—´è¿›è¡Œå¹³è¡¡å–èˆã€‚

å¼•æ“åº“ä½¿ç”¨`javascript`ç¼–å†™ï¼Œæˆ‘ä»¬å¯¹ DOM èŠ‚ç‚¹æ’å…¥ã€åˆ é™¤ã€æ›¿æ¢ç­‰ä¸€ç³»åˆ—æ“ä½œã€åŒ…æ‹¬å…‰æ ‡ã€äº‹ä»¶è¿›è¡Œäº†å°è£…å¹¶æ´¾ç”Ÿæ¥å£ã€‚å› æ­¤ï¼Œåœ¨å¼•æ“ä¸­æˆ‘ä»¬çš„æ‰€æœ‰æ“ä½œéƒ½å°†ç›´æ¥ç¼–è¾‘å¤æ‚çš„ DOM æ ‘ï¼Œåœ¨æ•°æ®ç»“æ„ä¸­æˆ‘ä»¬ä¹Ÿå°†ä»¥ DOM æ ‘ç»“æ„å‘ˆç°ã€‚ä¸è¿‡åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬éå¸¸æœ‰å¿…è¦å¯¹å¤æ‚çš„ DOM æ ‘ç»“æ„è¿›è¡Œçº¦æŸï¼Œä»¥å…å‡ºç°ä¸å¯é¢„æœŸçš„è¡Œä¸ºï¼Œå¹¶ä¸”åœ¨å½“å‰æµè¡Œä½¿ç”¨`React` `Vue`ç­‰å‰ç«¯æ¡†æ¶æ¥æ¸²æŸ“ UI çš„æƒ…å†µä¸‹ï¼Œè®©æˆ‘ä»¬å†ä½¿ç”¨`javascript`å®šåˆ¶ UI æ˜¯ä¸€ä»¶éå¸¸ç—›è‹¦çš„äº‹æƒ…ã€‚æ‰€ä»¥æˆ‘ä»¬æŠŠ DOM èŠ‚ç‚¹æŒ‰åŠŸèƒ½å’Œç‰¹æ€§åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š`mark` `inline` `block` `card` å¹¶ä¸”é€šè¿‡ `schema` æ¥çº¦æŸä»–ä»¬ç‰¹å®šçš„è¡Œä¸ºå’Œä¸€äº›ç‰¹è´¨å±æ€§ï¼Œåœ¨ `card` ç»„ä»¶ä¸­æˆ‘ä»¬è¿˜å¯ä»¥ç»“åˆå‰ç«¯æ¡†æ¶æ¥å®Œæˆå¤æ‚çš„ UI æ¸²æŸ“å’Œç¼–è¾‘åµŒå¥—ã€‚

åœ¨ç°ä»£åŒ–ä¼ä¸šä¸­ï¼ŒååŒåŠå…¬å·²æ˜¯é«˜æ•ˆçš„ä»£åè¯ã€‚åœ¨å³æ—¶é€šè®¯ã€è§†é¢‘ä¼šè®®ä¹‹åè®©æ–‡æ¡£ä¹ŸååŒèµ·æ¥ï¼Œå·²æ˜¯å¤§åŠ¿æ‰€è¶‹ã€‚åœ¨å¼•æ“åº“ä¸­ï¼Œæˆ‘ä»¬åŸºäº[ShareDB](https://github.com/share/sharedb)æä¾›ååŒç¼–è¾‘èƒ½åŠ›ï¼ŒæŠŠå¤æ‚çš„ DOM ç»“æ„è½¬æ¢ä¸º[JSON0](https://github.com/ottypes/json0)åè®®çš„æ•°æ®ç»“æ„åï¼Œæäº¤ç»™`sharedb`å¤„ç†ååŒç¼–è¾‘çš„äº¤äº’ã€‚

## ç‰¹æ€§

-   ğŸ“¦ å¼€ç®±å³ç”¨ï¼Œæä¾›å‡ åç§ä¸°å¯Œçš„æ’ä»¶æ¥æ»¡è¶³å¤§éƒ¨åˆ†éœ€æ±‚
-   ğŸ· é«˜æ‰©å±•æ€§ï¼Œé™¤äº†`mark` `inline` `block`åŸºç¡€æ’ä»¶å¤–ï¼Œæˆ‘ä»¬è¿˜æä¾›`card`ç»„ä»¶ç»“åˆ`React` `Vue`ç­‰å‰ç«¯æ¡†æ¶æ¸²æŸ“æ’ä»¶ UI
-   ğŸ“‹ ä¸°å¯Œçš„å¤šåª’ä½“æ”¯æŒï¼Œä¸ä»…æ”¯æŒå›¾ç‰‡å’ŒéŸ³è§†é¢‘ï¼Œæ›´æ”¯æŒæ’å…¥åµŒå…¥å¼å¤šåª’ä½“å†…å®¹
-   ğŸ  ä¸ä¾èµ–å‰ç«¯æ¡†æ¶ï¼Œå¤æ‚æ¶æ„è½»æ¾åº”å¯¹
-   ğŸ“¡ å†…ç½®ååŒç¼–è¾‘æ–¹æ¡ˆï¼Œè½»é‡é…ç½®å³å¯ä½¿ç”¨
-   ğŸ“± å…¼å®¹å¤§éƒ¨åˆ†æœ€æ–°ç§»åŠ¨ç«¯æµè§ˆå™¨

## æ‰€æœ‰æ’ä»¶

-   [x] `@aomao/plugin-alignment` å¯¹é½æ–¹å¼
-   [x] `@aomao/plugin-backcolor` èƒŒæ™¯è‰²
-   [x] `@aomao/plugin-bold` åŠ ç²—
-   [x] `@aomao/plugin-code` è¡Œå†…ä»£ç 
-   [x] `@aomao/plugin-codelock` å—çº§ä»£ç 
-   [x] `@aomao/plugin-fontcolor` å‰æ™¯è‰²
-   [x] `@aomao/plugin-fontsize` å­—ä½“å¤§å°
-   [x] `@aomao/plugin-heading` æ ‡é¢˜
-   [x] `@aomao/plugin-hr` åˆ†å‰²çº¿
-   [x] `@aomao/plugin-indent` ç¼©è¿›
-   [x] `@aomao/plugin-italic` æ–œä½“
-   [x] `@aomao/plugin-link` é“¾æ¥
-   [x] `@aomao/plugin-mark` æ ‡è®°
-   [x] `@aomao/plugin-orderedlist` æœ‰åºåˆ—è¡¨
-   [x] `@aomao/plugin-paintformat` æ ¼å¼åˆ·
-   [x] `@aomao/plugin-quote` å¼•ç”¨
-   [x] `@aomao/plugin-redo` é‡åšå†å²
-   [x] `@aomao/plugin-removeformat` ç§»é™¤æ ¼å¼
-   [x] `@aomao/plugin-selectall` å…¨é€‰
-   [x] `@aomao/plugin-strikethrough` åˆ é™¤çº¿
-   [x] `@aomao/plugin-sub` ä¸‹æ ‡
-   [x] `@aomao/plugin-sup` ä¸Šæ ‡
-   [x] `@aomao/plugin-tasklist` ä»»åŠ¡åˆ—è¡¨
-   [x] `@aomao/plugin-underline` ä¸‹åˆ’çº¿
-   [x] `@aomao/plugin-undo` æ’¤é”€å†å²
-   [x] `@aomao/plugin-unorderedlist` æ— åºåˆ—è¡¨
-   [x] `@aomao/plugin-image` å›¾ç‰‡
-   [x] `@aomao/plugin-table` è¡¨æ ¼
-   [x] `@aomao/plugin-file` é™„ä»¶
-   [x] `@aomao/plugin-mark-range` å…‰æ ‡èŒƒå›´æ ‡è®°
-   [x] `@aomao/plugin-video` è§†é¢‘
-   [x] `@aomao/plugin-math` æ•°å­¦å…¬å¼

## å¿«é€Ÿä¸Šæ‰‹

### å®‰è£…

am-editor ä¸­`å¼•æ“`ã€`å·¥å…·æ `ã€`æ¯ä¸ªæ’ä»¶`éƒ½æ˜¯å•ç‹¬çš„åŒ…ã€‚å…¶ä¸­`å¼•æ“`æ˜¯æœ€æ ¸å¿ƒçš„åŒ…ï¼Œå…¶å®ƒåŒ…éƒ½å°†ä¾èµ–å®ƒ

ä½¿ç”¨ npm æˆ–è€… yarn å®‰è£…å¼•æ“åŒ…

```bash
$ npm install @aomao/engine
# or
$ yarn add @aomao/engine
```

`Vue` ä½¿ç”¨è€…è¯·çœ‹ [https://github.com/itellyou-com/am-editor/tree/master/demo-vue](https://github.com/itellyou-com/am-editor/tree/master/demo-vue)

### ä½¿ç”¨

æˆ‘ä»¬æŒ‰ç…§æƒ¯ä¾‹å…ˆè¾“å‡ºä¸€ä¸ª`Hello word!`

```tsx
import React, { useEffect, useRef, useState } from 'react';
import Engine, { EngineInterface } from '@aomao/engine';

const EngineDemo = () => {
	//ç¼–è¾‘å™¨å®¹å™¨
	const ref = useRef<HTMLDivElement | null>(null);
	//å¼•æ“å®ä¾‹
	const [engine, setEngine] = useState<EngineInterface>();
	//ç¼–è¾‘å™¨å†…å®¹
	const [content, setContent] = useState<string>('Hello word!');

	useEffect(() => {
		if (!ref.current) return;
		//å®ä¾‹åŒ–å¼•æ“
		const engine = new Engine(ref.current);
		//åˆå§‹åŒ–æœ¬åœ°åä½œï¼Œç”¨ä½œè®°å½•å†å²
		engine.ot.initLockMode();
		//è®¾ç½®ç¼–è¾‘å™¨å€¼
		engine.setValue(content);
		//ç›‘å¬ç¼–è¾‘å™¨å€¼æ”¹å˜äº‹ä»¶
		engine.on('change', (value) => {
			setContent(value);
			console.log(`value:${value}`);
		});
		//è®¾ç½®å¼•æ“å®ä¾‹
		setEngine(engine);
	}, []);

	return <div ref={ref} />;
};
export default EngineDemo;
```

### æ’ä»¶

ç°åœ¨æˆ‘ä»¬åœ¨ä¸Šè¯‰ä»£ç åŸºç¡€ä¸Šï¼Œå¼•å…¥`@aomao/plugin-bold`åŠ ç²—æ’ä»¶

```tsx
import Bold from '@aomao/plugin-bold';
```

ç„¶åå°†`Bold`æ’ä»¶åŠ å…¥å¼•æ“

```tsx
//å®ä¾‹åŒ–å¼•æ“
const engine = new Engine(ref.current, {
	plugin: [Bold],
});
```

### å¡ç‰‡

å¡ç‰‡æ˜¯ç¼–è¾‘å™¨ä¸­å•ç‹¬åˆ’åˆ†çš„ä¸€ä¸ªåŒºåŸŸï¼Œå…¶ UI ä»¥åŠé€»è¾‘åœ¨å¡ç‰‡å†…éƒ¨å¯ä»¥ä½¿ç”¨ Reactã€Vue æˆ–å…¶å®ƒæ¡†æ¶è‡ªå®šä¹‰æ¸²æŸ“å†…å®¹ï¼Œæœ€åå†æŒ‚è½½åˆ°ç¼–è¾‘å™¨ä¸Šã€‚

å¼•å…¥`@aomao/plugin-codeblock`ä»£ç å—æ’ä»¶ï¼Œè¿™ä¸ªæ’ä»¶éƒ¨åˆ† UI ä½¿ç”¨æ¡†æ¶æ¸²æŸ“ï¼Œæ‰€ä»¥æœ‰åŒºåˆ†ã€‚ `vue`å¼€å‘è€…ä½¿ç”¨ `@aomao/plugin-codeblock-vue`

```tsx
import CodeBlock, { CodeBlockComponent } from '@aomao/plugin-codeblock';
```

å°†`CodeBlock`æ’ä»¶å’Œ`CodeBlockComponent`å¡ç‰‡ç»„ä»¶åŠ å…¥å¼•æ“

```tsx
//å®ä¾‹åŒ–å¼•æ“
const engine = new Engine(ref.current, {
	plugins: [CodeBlock],
	cards: [CodeBlockComponent],
});
```

`CodeBlock`æ’ä»¶é»˜è®¤æ”¯æŒ`markdown`ï¼Œåœ¨ç¼–è¾‘å™¨ä¸€è¡Œå¼€å¤´ä½ç½®è¾“å…¥ä»£ç å—è¯­æ³•` ```javascript `å›è½¦åï¼Œçœ‹çœ‹æ•ˆæœå§

### å·¥å…·æ 

å¼•å…¥`@aomao/toolbar`å·¥å…·æ ï¼Œå·¥å…·æ åŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨æ¡†æ¶æ¸²æŸ“ï¼Œ`vue`å¼€å‘è€…ä½¿ç”¨ `@aomao/toolbar-vue`

```tsx | pure
import Toolbar, { ToolbarPlugin, ToolbarComponent } from '@aomao/toolbar';
```

å°†`ToolbarPlugin`æ’ä»¶å’Œ`ToolbarComponent`å¡ç‰‡ç»„ä»¶åŠ å…¥å¼•æ“ï¼Œå®ƒå°†è®©æˆ‘ä»¬åœ¨ç¼–è¾‘å™¨ä¸­å¯ä»¥ä½¿ç”¨å¿«æ·é”®`/`å”¤é†’å‡ºå·¥å…·æ 

```tsx
//å®ä¾‹åŒ–å¼•æ“
const engine = new Engine(ref.current, {
	plugins: [ToolbarPlugin],
	cards: [ToolbarComponent],
});
```

æ¸²æŸ“å·¥å…·æ ï¼Œå·¥å…·æ å·²é…ç½®å¥½æ‰€æœ‰æ’ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦ä¼ å…¥æ’ä»¶åç§°å³å¯

```tsx
return (
    ...
    {
        engine && (
            <Toolbar
                engine={engine}
                items={[
                    ['collapse'],
                    [
                        'bold',
                    ],
                ]}
            />
        )
    }
    ...
)
```

### ååŒç¼–è¾‘

ååŒç¼–è¾‘åŸºäº[ShareDB](https://github.com/share/sharedb)å®ç°ã€‚æ¯ä½ç¼–è¾‘è€…ä½œä¸º[å®¢æˆ·ç«¯](https://github.com/itellyou-com/am-editor/blob/master/docs/demo/ot-client.ts)é€šè¿‡`WebSocket`ä¸[æœåŠ¡ç«¯](https://github.com/itellyou-com/am-editor/tree/master/ot-server)é€šä¿¡äº¤æ¢æ•°æ®ã€‚ç¼–è¾‘å™¨å¤„ç†æ•°æ®ã€æ¸²æŸ“æ•°æ®ã€‚

æˆ‘ä»¬å°† å®¢æˆ·ç«¯ å’Œ æœåŠ¡ç«¯ æ­å»ºå¥½å å¼€å¯ååŒç¼–è¾‘ã€‚[æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹](https://github.com/itellyou-com/am-editor/blob/master/docs/demo/engine.tsx)

```tsx | pure
//å®ä¾‹åŒ–åä½œç¼–è¾‘å®¢æˆ·ç«¯ï¼Œä¼ å…¥å½“å‰ç¼–è¾‘å™¨å¼•æ“å®ä¾‹
const otClient = new OTClient(engine);
//è¿æ¥åˆ°åä½œæœåŠ¡ç«¯ï¼Œ`demo` ä¸æœåŠ¡ç«¯æ–‡æ¡£IDç›¸åŒ
otClient.connect(
	`ws://127.0.0.1:8080${currentMember ? '?uid=' + currentMember.id : ''}`,
	'demo',
);
```

### é¡¹ç›®å›¾æ ‡

[Iconfont](https://at.alicdn.com/t/project/1456030/575170a6-50ef-4156-9ad0-2cd0341752a7.html?spm=a313x.7781069.1998910419.35)

## è´¡çŒ®

### æ”¯ä»˜å®

![alipay](https://cdn-object.aomao.com/contribution/alipay.png?x-oss-process=image/resize,w_200)

### å¾®ä¿¡æ”¯ä»˜

![wechat](https://cdn-object.aomao.com/contribution/weichat.png?x-oss-process=image/resize,w_200)

### PayPal

[https://paypal.me/aomaocom](https://paypal.me/aomaocom)
